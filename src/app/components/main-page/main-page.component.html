<div class="page-container">
    <div class="cars-list-container">
        <mat-card appearance="outlined">
            <mat-card-content>
                <p><strong>Cars list:</strong></p>
                <ng-container *ngIf="cars.length; else noCarsTemplate">
                    <cdk-accordion class="example-accordion">
                        @for (car of cars; track car; let index = $index) {
                        <cdk-accordion-item #accordionItem="cdkAccordionItem" class="example-accordion-item"
                            role="button" tabindex="0" [attr.id]="'accordion-header-' + index"
                            [attr.aria-expanded]="accordionItem.expanded"
                            [attr.aria-controls]="'accordion-body-' + index">
                            <div class="example-accordion-item-header" (click)="accordionItem.toggle()">
                                <strong>VIN </strong> {{ car.vin }}
                            </div>
                            <div class="example-accordion-item-body" role="region"
                                [style.display]="accordionItem.expanded ? '' : 'none'"
                                [attr.id]="'accordion-body-' + index"
                                [attr.aria-labelledby]="'accordion-header-' + index">

                                <p>
                                    <strong> VIN: </strong> {{car.vin}}
                                </p>
                                <p>
                                    <strong> Brand: </strong> {{car.brand}}
                                </p>
                                <p>
                                    <strong> Model: </strong> {{car.model}}
                                </p>
                                <p>
                                    <strong> Production year: </strong> {{car.productionYear}}
                                </p>
                                <p>
                                    <strong>Services: </strong>
                                </p>
                                <ng-container *ngFor="let service of car.services">
                                    <p> - Service cost: {{service.serviceCost}} PLN</p>
                                    <p> - Total cost: {{service.totalCost}} PLN</p>
                                    <p> <strong> Parts: </strong></p>
                                    <ng-container *ngFor="let part of service.parts">
                                        <p> - {{part.name}}: {{part.cost}} PLN, {{part.quantity}} pcs</p>
                                    </ng-container>

                                    <mat-divider></mat-divider>
                                </ng-container>
                            </div>
                        </cdk-accordion-item>
                        }
                    </cdk-accordion>
                </ng-container>
                <ng-template #noCarsTemplate>
                    Brak samochod√≥w
                </ng-template>
            </mat-card-content>
        </mat-card>
    </div>

    <div class="form-container">
        <mat-card appearance="outlined">
            <mat-card-content>
                <form [formGroup]="newCarForm">
                    <p><strong>Car:</strong></p>
                    <mat-form-field>
                        <mat-label>VIN</mat-label>
                        <input formControlName="vin" matInput>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Brand</mat-label>
                        <input formControlName="brand" matInput>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Model</mat-label>
                        <input formControlName="model" matInput>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Production year</mat-label>
                        <input formControlName="productionYear" matInput>
                    </mat-form-field>

                </form>
                <button (click)="addCar()" mat-flat-button>Add car</button>
            </mat-card-content>
        </mat-card>

    </div>
    <div class="form-container">
        <mat-card appearance="outlined">
            <mat-card-content>
                <form [formGroup]="newServiceForm">
                    <p><strong>Service:</strong></p>
                    <mat-form-field>
                        <mat-label>VIN</mat-label>
                        <input formControlName="vin" matInput>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>Service cost</mat-label>
                        <input formControlName="serviceCost" matInput>
                    </mat-form-field>
                    <strong>Parts:</strong>
                    <ng-container *ngIf="!!currentServiceParts.length; else noPartsTemplate">
                        <p *ngFor="let item of currentServiceParts">
                            {{item.name}}: {{item.cost}} PLN, {{item.quantity}} pcs
                        </p>
                    </ng-container>
                    <ng-template #noPartsTemplate>
                        <p>No parts used.</p>
                    </ng-template>
                </form>
                <mat-card class="part-form-card" appearance="outlined">
                    <form [formGroup]="newPartForm">
                        <mat-form-field>
                            <mat-label>Name</mat-label>
                            <input formControlName="name" matInput>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>Cost</mat-label>
                            <input formControlName="cost" matInput>
                        </mat-form-field>
                        <mat-form-field>
                            <mat-label>Quantity</mat-label>
                            <input formControlName="quantity" matInput>
                        </mat-form-field>

                        <button (click)="addPart()" mat-flat-button>Add part</button>
                    </form>
                </mat-card>
                <button (click)="addService()" mat-flat-button>Add service</button>
            </mat-card-content>
        </mat-card>

    </div>
</div>